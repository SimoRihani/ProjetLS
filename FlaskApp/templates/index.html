<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Force latest IE rendering engine or ChromeFrame if installed -->
<!--[if IE]>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<![endif]-->
<meta charset="utf-8">
<link rel="icon" type="image/png" href="static/pic/icon.png" />
<title>Evaluate !</title>
<meta name="description" content="File Upload widget with multiple file selection, drag&amp;drop support, progress bars, validation and preview images, audio and video for jQuery. Supports cross-domain, chunked and resumable file uploads and client-side image resizing. Works with any server-side platform (PHP, Python, Ruby on Rails, Java, Node.js, Go etc.) that supports standard HTML form file uploads.">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Bootstrap styles -->
<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
<!-- Generic page styles -->
<link rel="stylesheet" href="static/style.css">
<!-- blueimp Gallery styles -->
<script src="http://code.jquery.com/jquery-latest.min.js"
        type="text/javascript"></script>
        <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
        <script src="http://cdn.opencpu.org/opencpu-0.4.js"></script>
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.2/css/bootstrap-select.min.css">
</head>
<body>
  <!--navigation-->
  <nav class="navbar navbar-default navbar-fixed-left" id="nav_bar">
    <a class="navbar-brand" href="#"><span class="glyphicon glyphicon-align-left"></span> Evaluate !</a><br /><br /><br /><br />
    <span style="margin-left:30px;color:#43484d"><span class="glyphicon glyphicon-menu-right"></span> H.Boukrim</span><br />
    <span style="margin-left:30px;color:#43484d"><span class="glyphicon glyphicon-menu-right"></span> J.Diantouba</span><br />
    <span style="margin-left:30px;color:#43484d"><span class="glyphicon glyphicon-menu-right"></span> O.Dibt</span><br />
    <span style="margin-left:30px;color:#43484d"><span class="glyphicon glyphicon-menu-right"></span> M.Rihani</span><br />
    <ul class="nav navbar-nav" id="tt"><br />
      <li><span style="margin-left:30px;color:#43484d"><span class="glyphicon glyphicon-lock"></span> LS - Project </span></li><br />
     <li><span style="margin-left:8px;color:#43484d;font-style: italic"><span class="glyphicon glyphicon-education"></span> M2 Miage ID App.</span></li>
     <li><span style="margin-left:45px;color:#43484d"> 2016-2017 </span></li>
     <li style="margin-left:-7px;"><a href="http://www.dauphine.fr/fr/index.html" target="_blank"><img src="static/pic/logoD.png" class="logoEcole" alt="Logo Paris-Dauphine" width="140" /></a></li>
    </ul>
  </nav>
  <div id="bd" class="wrapper">
<h1>  Evaluation based on several criteria</h1><br />
<div>
<span style="font-style: italic">Evaluate !</span> is a tool to evaluate different alternatives, by making a ranking from the best one to the worst.<br />
Based on two documents to be attached : the first for the desired configuration (different weightings of the criteria)
and the second for the data, you can apply one of the three evaluation methods available.
</div><br />

<b> <span class="glyphicon glyphicon-paperclip"></span> Configuration file</b> <input type="file" id="csvfile">
<br />

<b> <span class="glyphicon glyphicon-paperclip"></span> Data file</b> <input type="file" id="csvfile2">
<br />

<b> <span class="glyphicon glyphicon-cog"></span> Evaluation method </b> <select id="header" name="header" class="form-control" style="width:53%">
<option value="1">1-Evaluate by a weighted sum</option>
<option value="2">2-Evaluate by a weighted sum taking into account the interaction between criterion</option>
<option value="3">3-Evaluate with the ELECTRE TRI method</option><br />
</select>


<br />
<button id="submitbutton" type="button" class="btn btn-primary"><span class="glyphicon glyphicon-send"></span> GO </button><br /><br />

<div name="out" id="out"><pre><code id="output"></code></pre></div><br /><br />
<pre><code id="output2"></code></pre>

<script>
// (function($){
//     $(document).ready(function(){
//         var offset = $(".navbar").offset().top;
//         $(document).scroll(function(){
//             var scrollTop = $(document).scrollTop();
//             if(scrollTop > offset){
//                 $(".navbar").css("position", "fixed");
//             }
//             else {
//                 $(".navbar").css("position", "static");
//             }
//         });
//     });
// })(jQuery);

  // $(window).scroll(function () {
  //     //if you hard code, then use console
  //     //.log to determine when you want the
  //     //nav bar to stick.
  //     console.log($(window).scrollTop())
  //   if ($(window).scrollTop() > 0) {
  //     $('#nav_bar').marginTop = $(window).scrollTop();
  //     console.log("$(window).scrollTop()");
  //   }
  //   if ($(window).scrollTop() < 1) {
  //     $('#nav_bar').removeClass('navbar-fixed-left');
  //   }
  // });

//because read.csv is in utils
ocpu.seturl("http://public.opencpu.org/ocpu/library/utils/R")
//actual handler
$("#submitbutton").on("click", function(){

    //arguments
    var myheader = $("#header").val() == 1;
    var myfile = $("#csvfile")[0].files[0];
    var myfile2 = $("#csvfile2")[0].files[0];
    var e = document.getElementById("header");
    //console.log(e.options[e.selectedIndex].text);
    var mydata = "";
    $.ajax({
        url: "/Users/SimoRihani/Desktop/ttg/tst.csv",
        async: false,
        success: function (csvd) {
            data = $.csv.toArrays(csvd);
        },
        dataType: "text",
        complete: function () {
            // call a function on complete
        }
    });


          $.ajax({
              url: '/indexAct',
              // data: e.options[e.selectedIndex].text,
              // data: $('#header').serialize(),
              data: $('#header').serialize(),
              //data: mydata,
              type: 'POST',
              success: function(response) {
                  console.log(response);
              },
              error: function(error) {
                  console.log(error);
              }
          });

    if(!myfile){
        alert("No file selected.");
        return;
    }

    //disable the button during upload
    $("#submitbutton").attr("disabled", "disabled");

    //perform the request
    var req = ocpu.call("read.csv", {
        "file" : myfile,
        "header" : myheader
    }, function(session){
        session.getConsole(function(outtxt){
            $("#output").text("Simo" + outtxt + mydata);
        });
    });

    var req2 = ocpu.call("read.csv", {
        "file" : myfile2,
        "header" : myheader
    }, function(session){
        session.getConsole(function(outtxt){
            $("#output2").text(outtxt + mydata);
        });
    });

    //if R returns an error, alert the error message
    req.fail(function(){
        alert("Server error: " + req.responseText);
    });

    //after request complete, re-enable the button
    req.always(function(){
        $("#submitbutton").removeAttr("disabled")
    });

    req2.fail(function(){
        alert("Server error: " + req2.responseText);
    });

    //after request complete, re-enable the button
    req2.always(function(){
        $("#submitbutton").removeAttr("disabled")
    });

});
</script>
</div>
</body>
</html>
